<!DOCTYPE html>
<html lang="pt-BR" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Separação de Cargas</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        body {
            background-color: #212529;
            font-family: 'Inter', sans-serif;
        }
        .card {
            background-color: #2b3035;
            border: 1px solid #495057;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.25), 0 2px 3px rgba(0,0,0,0.22);
            transition: all 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.29), 0 6px 6px rgba(0,0,0,0.23);
        }
        .accordion-button {
            background-color: #343a40;
            color: #f8f9fa;
        }
        .accordion-button:not(.collapsed) {
            background-color: #0d6efd;
            color: white;
        }
        .accordion-body {
            background-color: #2b3035;
        }
        .table-striped>tbody>tr:nth-of-type(odd)>* {
            --bs-table-accent-bg: var(--bs-table-striped-bg);
        }
        .status-message {
            min-height: 24px;
        }
        .btn {
            transition: all 0.2s ease-in-out;
        }
        .btn:hover {
            filter: brightness(1.1);
            transform: translateY(-2px);
        }
        @media print {
            body { background-color: #fff; color: #000; }
            .container, .card, .accordion-item, .accordion-body { background-color: #fff !important; color: #000 !important; border: none !important; box-shadow: none !important; }
            .no-print, .d-flex.align-items-center.mb-3, .card.p-3.mb-4.shadow-sm, button, .status-message, .card-subtitle, .accordion-button.collapsed, .accordion-collapse.collapse { display: none !important; }
            .table-responsive { overflow: visible !important; }
            table, th, td { border: 1px solid #dee2e6 !important; color: #000 !important; }
            h1, h2, h3, h4, h5 { color: #000 !important; margin-top: 1rem; margin-bottom: 0.5rem; }
            .accordion-collapse { display: block !important; }
            .accordion-button { display: block !important; background-color: #f8f9fa !important; color: #000 !important; border: 1px solid #dee2e6 !important; margin-bottom: 0.5rem; }
            .accordion-button strong, .accordion-button .badge { color: #000 !important; }
        }
        #drop-zone-text {
            border: 2px dashed #495057;
            border-radius: .25rem;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;
        }
        #drop-zone.border-primary #drop-zone-text {
            border-color: #0d6efd;
        }
    </style>
</head>
<body>
    <div class="container mt-4 mb-4">
        <div class="d-flex align-items-center mb-3">
            <i class="bi bi-truck display-4 me-3"></i>
            <h1 class="mb-0">Dashboard de Separação de Cargas</h1>
        </div>

        <div class="card p-3 mb-4 no-print" id="drop-zone">
            <div class="row g-3 align-items-center">
                <div class="col-md-4">
                    <label for="fileInput" class="form-label fw-bold">1. Arraste e solte a planilha:</label>
                    <input class="form-control" type="file" id="fileInput" accept=".xlsx, .xls, .csv" style="display: none;">
                    <div id="drop-zone-text" class="text-center p-5 border-2 border-dashed rounded-3">
                        <p><i class="bi bi-file-earmark-spreadsheet-fill fs-2"></i></p>
                        <p>Arraste o arquivo aqui ou</p>
                        <button type="button" class="btn btn-secondary" onclick="document.getElementById('fileInput').click()"><i class="bi bi-folder2-open me-2"></i>Selecionar Arquivo</button>
                    </div>
                </div>
                <div class="col-md-5">
                    <label class="form-label fw-bold">2. Defina a Faixa de Rotas (Opcional):</label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-signpost-split-fill"></i></span>
                        <input type="text" class="form-control" id="rotaInicialInput" placeholder="Rota Inicial">
                        <input type="text" class="form-control" id="rotaFinalInput" placeholder="Rota Final">
                    </div>
                </div>
                <div class="col-md-3 align-self-end">
                    <button class="btn btn-primary w-100 py-2" id="processarBtn" onclick="processar()" disabled><i class="bi bi-gear-fill me-2"></i>Processar Cargas</button>
                </div>
            </div>
            <div id="status" class="mt-2 status-message"></div>
        </div>

        <div class="card p-3 mb-4 no-print">
            <h2 class="card-title h5"><i class="bi bi-sliders me-2"></i>Configurações de Veículos</h2>
            <p class="card-subtitle mb-3 text-body-secondary small">Defina as capacidades de peso e cubagem para cada tipo de veículo.</p>
            <div class="row g-3">
                <div class="col-md-3">
                    <label for="fiorinoMaxCapacity" class="form-label">Fiorino - Peso Máx (kg)</label>
                    <input type="number" class="form-control config-input" id="fiorinoMaxCapacity" value="570" step="10">
                </div>
                <div class="col-md-3">
                    <label for="fiorinoMinCapacity" class="form-label">Fiorino - Peso Mín (kg)</label>
                    <input type="number" class="form-control config-input" id="fiorinoMinCapacity" value="330" step="10">
                </div>
                <div class="col-md-3">
                    <label for="fiorinoCubage" class="form-label">Fiorino - Cubagem Máx (m³)</label>
                    <input type="number" class="form-control config-input" id="fiorinoCubage" value="1.6" step="0.1">
                </div>
                <div class="col-md-3 d-flex align-items-end">
                    <button class="btn btn-secondary w-100" id="resetFiorino">Reset Fiorino</button>
                </div>

                <div class="col-md-3">
                    <label for="vanMaxCapacity" class="form-label">Van - Peso Máx (kg)</label>
                    <input type="number" class="form-control config-input" id="vanMaxCapacity" value="1560" step="10">
                </div>
                <div class="col-md-3">
                    <label for="vanMinCapacity" class="form-label">Van - Peso Mín (kg)</label>
                    <input type="number" class="form-control config-input" id="vanMinCapacity" value="1100" step="10">
                </div>
                <div class="col-md-3">
                    <label for="vanCubage" class="form-label">Van - Cubagem Máx (m³)</label>
                    <input type="number" class="form-control config-input" id="vanCubage" value="5.0" step="0.1">
                </div>
                <div class="col-md-3 d-flex align-items-end">
                    <button class="btn btn-secondary w-100" id="resetVan">Reset Van</button>
                </div>

                <div class="col-md-3">
                    <label for="tresQuartosMaxCapacity" class="form-label">3/4 - Peso Máx (kg)</label>
                    <input type="number" class="form-control config-input" id="tresQuartosMaxCapacity" value="4100" step="10">
                </div>
                <div class="col-md-3">
                    <label for="tresQuartosMinCapacity" class="form-label">3/4 - Peso Mín (kg)</label>
                    <input type="number" class="form-control config-input" id="tresQuartosMinCapacity" value="2300" step="10">
                </div>
                <div class="col-md-3">
                    <label for="tresQuartosCubage" class="form-label">3/4 - Cubagem Máx (m³)</label>
                    <input type="number" class="form-control config-input" id="tresQuartosCubage" value="15.0" step="0.1">
                </div>
                <div class="col-md-3 d-flex align-items-end">
                    <button class="btn btn-secondary w-100" id="resetTresQuartos">Reset 3/4</button>
                </div>

                <div class="col-md-3">
                    <label for="tocoMaxCapacity" class="form-label">Toco - Peso Máx (kg)</label>
                    <input type="number" class="form-control config-input" id="tocoMaxCapacity" value="8500" step="10">
                </div>
                <div class="col-md-3">
                    <label for="tocoMinCapacity" class="form-label">Toco - Peso Mín (kg)</label>
                    <input type="number" class="form-control config-input" id="tocoMinCapacity" value="5000" step="10">
                </div>
                <div class="col-md-3">
                    <label for="tocoCubage" class="form-label">Toco - Cubagem Máx (m³)</label>
                    <input type="number" class="form-control config-input" id="tocoCubage" value="30.0" step="0.1">
                </div>
                <div class="col-md-3 d-flex align-items-end">
                    <button class="btn btn-secondary w-100" id="resetToco">Reset Toco</button>
                </div>
            </div>
            <div class="mt-3 d-flex justify-content-end">
                <button class="btn btn-success me-2" id="saveConfig">Salvar Configurações</button>
                <button class="btn btn-danger" id="resetAllConfigs">Resetar Todas</button>
            </div>
             <div id="configStatus" class="mt-2 status-message"></div>
        </div>

        <div class="row">
            <div class="col-lg-12 mb-4">
                <div class="card shadow-sm h-100">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                             <h2 class="card-title h5"><i class="bi bi-list-check me-2"></i>Resultados Gerais</h2>
                             <button class="btn btn-sm btn-outline-light no-print" onclick="window.print()"><i class="bi bi-printer-fill me-1"></i> Imprimir Tudo</button>
                        </div>
                        <p class="card-subtitle mb-2 text-body-secondary small">Pedidos que não são 'Toco', agrupados por rota.</p>
                        <div class="input-group mb-3 no-print">
                            <input type="text" id="pedidoSearchInput" class="form-control" placeholder="Buscar por Nº do Pedido...">
                            <button class="btn btn-outline-secondary" type="button" onclick="buscarPedido()"><i class="bi bi-search"></i></button>
                        </div>
                        <div id="search-result" class="mb-3"></div>
                        <div id="resultado-geral"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 mb-4">
                <div class="card shadow-sm h-100">
                    <div class="card-body">
                        <h2 class="card-title h5 text-success"><i class="bi bi-box-seam me-2"></i>Separação de Cargas (Fiorino)</h2>
                        <p class="card-subtitle mb-2 text-body-secondary small">Selecione uma rota de Fiorino para separar as cargas. O sistema tentará promover sobras para uma Van se houver pedidos grandes.</p>
                        <div class="no-print">
                            <button class="btn btn-success mt-2" onclick="separarCargasFiorino('11101', 'resultado-fiorino-geral', 'Rota 11101')">Rota 11101</button>
                            <button class="btn btn-success mt-2" onclick="separarCargasFiorino('11301', 'resultado-fiorino-geral', 'Rota 11301')">Rota 11301</button>
                            <button class="btn btn-success mt-2" onclick="separarCargasFiorino('11311', 'resultado-fiorino-geral', 'Rota 11311')">Rota 11311</button>
                            <button class="btn btn-success mt-2" onclick="separarCargasFiorino('11561', 'resultado-fiorino-geral', 'Rota 11561')">Rota 11561</button>
                            <button class="btn btn-success mt-2" onclick="separarCargasFiorino(['11721', '11731'], 'resultado-fiorino-geral', 'Rotas 11721 & 11731')">Rotas 11721 & 11731</button>
                        </div>
                        <div id="resultado-fiorino-geral" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-lg-12 mb-4">
                <div class="card shadow-sm h-100">
                    <div class="card-body">
                        <h2 class="card-title h5 text-primary"><i class="bi bi-truck-front me-2"></i>Separação de Cargas (Van)</h2>
                        <p class="card-subtitle mb-2 text-body-secondary small">Selecione uma rota de Van para separar as cargas. O sistema tentará promover sobras para um 3/4 se houver pedidos grandes.</p>
                        <div class="no-print">
                            <button class="btn btn-primary mt-2" onclick="separarCargasVan('11102', 'resultado-van-geral', 'Rota 11102')">Rota 11102</button>
                            <button class="btn btn-primary mt-2" onclick="separarCargasVan('11331', 'resultado-van-geral', 'Rota 11331')">Rota 11331</button>
                            <button class="btn btn-primary mt-2" onclick="separarCargasVan('11341', 'resultado-van-geral', 'Rota 11341')">Rota 11341</button>
                            <button class="btn btn-primary mt-2" onclick="separarCargasVan('11342', 'resultado-van-geral', 'Rota 11342')">Rota 11342</button>
                            <button class="btn btn-primary mt-2" onclick="separarCargasVan('11351', 'resultado-van-geral', 'Rota 11351')">Rota 11351</button>
                            <button class="btn btn-primary mt-2" onclick="separarCargasVan('11521', 'resultado-van-geral', 'Rota 11521')">Rota 11521</button>
                            <button class="btn btn-primary mt-2" onclick="separarCargasVan('11531', 'resultado-van-geral', 'Rota 11531')">Rota 11531</button>
                            <button class="btn btn-primary mt-2" onclick="separarCargasVan('11551', 'resultado-van-geral', 'Rota 11551')">Rota 11551</button>
                            <button class="btn btn-primary mt-2" onclick="separarCargasVan('11571', 'resultado-van-geral', 'Rota 11571')">Rota 11571</button>
                            <button class="btn btn-primary mt-2" onclick="separarCargasVan('11701', 'resultado-van-geral', 'Rota 11701')">Rota 11701</button>
                            <button class="btn btn-primary mt-2" onclick="separarCargasVan('11711', 'resultado-van-geral', 'Rota 11711')">Rota 11711</button>
                        </div>
                        <div id="resultado-van-geral" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 mb-4">
                <div class="card shadow-sm h-100">
                    <div class="card-body">
                        <h2 class="card-title h5 text-warning"><i class="bi bi-truck-flatbed me-2"></i>Separação de Cargas (3/4)</h2>
                        <p class="card-subtitle mb-2 text-body-secondary small">Selecione uma rota de 3/4 para separar as cargas.</p>
                         <div class="no-print">
                            <button class="btn btn-warning mt-2" onclick="separarCargas34('11361', 'resultado-34-geral', 'Rota 11361')">Rota 11361</button>
                            <button class="btn btn-warning mt-2" onclick="separarCargas34(['11501', '11502', '11511'], 'resultado-34-geral', 'Rotas 11501, 11502 & 11511')">Rotas 11501, 11502 & 11511</button>
                            <button class="btn btn-warning mt-2" onclick="separarCargas34('11541', 'resultado-34-geral', 'Rota 11541')">Rota 11541</button>
                        </div>
                        <div id="resultado-34-geral" class="mt-3"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 mb-4">
                <div class="card shadow-sm h-100">
                    <div class="card-body">
                        <h2 class="card-title h5"><i class="bi bi-lightning-charge-fill me-2"></i>Resultados Cargas 3/4 (Automático)</h2>
                        <p class="card-subtitle mb-2 text-body-secondary small">Cargas formadas a partir de um pedido muito grande.</p>
                        <div id="resultado-tres-quartos"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 mb-4">
                <div class="card shadow-sm h-100">
                    <div class="card-body">
                        <h2 class="card-title h5"><i class="bi bi-inboxes-fill me-2"></i>Resultados das Cargas "Toco"</h2>
                        <p class="card-subtitle mb-2 text-body-secondary small">Grupos de cargas onde a Coluna4/5 contém "TOCO" e o CF se repete.</p>
                        <div id="resultado-toco"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script>
        // <-- INÍCIO DA BASE DE DADOS DE CLIENTES (EXTRAÍDO DO PDF)
        const clientStatusMap = {
            '001398': { agendado: true, palletizado: true, urgente: false },
            '001494': { agendado: true, palletizado: false, urgente: false },
            '004277': { agendado: false, palletizado: true, urgente: false },
            '004639': { agendado: true, palletizado: true, urgente: false },
            '004872': { agendado: true, palletizado: true, urgente: false },
            '005546': { agendado: true, palletizado: true, urgente: false },
            '006896': { agendado: true, palletizado: false, urgente: false },
            '007981': { agendado: false, palletizado: true, urgente: false },
            '011238': { agendado: true, palletizado: true, urgente: false },
            '014066': { agendado: false, palletizado: true, urgente: false },
            '014776': { agendado: false, palletizado: true, urgente: false },
            '017163': { agendado: true, palletizado: true, urgente: false },
            '019622': { agendado: true, palletizado: true, urgente: false },
            '020350': { agendado: true, palletizado: false, urgente: false },
            '022545': { agendado: true, palletizado: true, urgente: false },
            '023024': { agendado: false, palletizado: true, urgente: false },
            '023556': { agendado: true, palletizado: false, urgente: false },
            '023761': { agendado: true, palletizado: true, urgente: false },
            '024465': { agendado: true, palletizado: true, urgente: false },
            '024581': { agendado: false, palletizado: true, urgente: false },
            '026778': { agendado: false, palletizado: true, urgente: false },
            '029302': { agendado: true, palletizado: true, urgente: false },
            '032462': { agendado: true, palletizado: true, urgente: false },
            '032680': { agendado: false, palletizado: true, urgente: false },
            '032831': { agendado: true, palletizado: true, urgente: false },
            '032851': { agendado: true, palletizado: true, urgente: false },
            '032869': { agendado: true, palletizado: true, urgente: false },
            '032905': { agendado: true, palletizado: false, urgente: false },
            '033039': { agendado: true, palletizado: false, urgente: false },
            '033046': { agendado: true, palletizado: false, urgente: false },
            '033047': { agendado: true, palletizado: true, urgente: false },
            '033107': { agendado: true, palletizado: false, urgente: false },
            '033388': { agendado: true, palletizado: false, urgente: false },
            '033392': { agendado: true, palletizado: false, urgente: false },
            '033400': { agendado: true, palletizado: false, urgente: false },
            '033401': { agendado: true, palletizado: true, urgente: false },
            '033403': { agendado: true, palletizado: true, urgente: false },
            '033406': { agendado: true, palletizado: false, urgente: false },
            '033420': { agendado: true, palletizado: false, urgente: false },
            '033494': { agendado: true, palletizado: false, urgente: false },
            '033676': { agendado: true, palletizado: false, urgente: false },
            '033762': { agendado: true, palletizado: true, urgente: false },
            '033818': { agendado: true, palletizado: false, urgente: false },
            '033859': { agendado: true, palletizado: true, urgente: false },
            '033884': { agendado: false, palletizado: true, urgente: false },
            '033907': { agendado: true, palletizado: false, urgente: false },
            '033971': { agendado: true, palletizado: true, urgente: false },
            '034011': { agendado: true, palletizado: false, urgente: false },
            '034080': { agendado: false, palletizado: true, urgente: false },
            '034096': { agendado: true, palletizado: false, urgente: false },
            '034167': { agendado: true, palletizado: false, urgente: false },
            '034425': { agendado: true, palletizado: false, urgente: false },
            '034511': { agendado: true, palletizado: true, urgente: false },
            '034810': { agendado: true, palletizado: true, urgente: false },
            '034981': { agendado: true, palletizado: false, urgente: false },
            '035050': { agendado: true, palletizado: true, urgente: false },
            '035054': { agendado: true, palletizado: false, urgente: false },
            '035798': { agendado: true, palletizado: false, urgente: false },
            '036025': { agendado: true, palletizado: true, urgente: false },
            '036580': { agendado: true, palletizado: true, urgente: false },
            '036743': { agendado: false, palletizado: true, urgente: false },
            '036792': { agendado: true, palletizado: true, urgente: false },
            '036853': { agendado: true, palletizado: false, urgente: false },
            '036945': { agendado: true, palletizado: false, urgente: false },
            '037101': { agendado: true, palletizado: false, urgente: false },
            '037589': { agendado: true, palletizado: false, urgente: false },
            '037634': { agendado: true, palletizado: false, urgente: false },
            '037699': { agendado: false, palletizado: true, urgente: false },
            '038207': { agendado: true, palletizado: false, urgente: false },
            '038448': { agendado: true, palletizado: false, urgente: false },
            '038482': { agendado: true, palletizado: false, urgente: false },
            '038564': { agendado: true, palletizado: true, urgente: false },
            '038681': { agendado: true, palletizado: true, urgente: false },
            '038735': { agendado: true, palletizado: true, urgente: false },
            '038896': { agendado: true, palletizado: true, urgente: false },
            '039081': { agendado: true, palletizado: true, urgente: false },
            '039177': { agendado: true, palletizado: false, urgente: false },
            '039620': { agendado: true, palletizado: false, urgente: false },
            '040144': { agendado: true, palletizado: false, urgente: false },
            '040159': { agendado: false, palletizado: true, urgente: false },
            '040442': { agendado: true, palletizado: false, urgente: false },
            '040702': { agendado: true, palletizado: true, urgente: false },
            '040844': { agendado: true, palletizado: true, urgente: false },
            '041233': { agendado: true, palletizado: false, urgente: false },
            '042200': { agendado: true, palletizado: false, urgente: false },
            '042765': { agendado: true, palletizado: false, urgente: false },
            '045265': { agendado: false, palletizado: true, urgente: false },
            '047244': { agendado: true, palletizado: false, urgente: false },
            '047253': { agendado: true, palletizado: true, urgente: false },
            '047349': { agendado: false, palletizado: true, urgente: false },
            '050151': { agendado: true, palletizado: false, urgente: false },
            '050816': { agendado: true, palletizado: true, urgente: false },
            '051818': { agendado: false, palletizado: true, urgente: false },
            '051993': { agendado: true, palletizado: false, urgente: false },
            '052780': { agendado: true, palletizado: true, urgente: false },
            '053134': { agendado: false, palletizado: true, urgente: false },
            '057593': { agendado: false, palletizado: true, urgente: false },
            '058645': { agendado: true, palletizado: true, urgente: false },
            '060900': { agendado: true, palletizado: false, urgente: false },
            '061182': { agendado: true, palletizado: false, urgente: false },
            '061315': { agendado: false, palletizado: true, urgente: false },
            '061316': { agendado: true, palletizado: true, urgente: false },
            '061317': { agendado: true, palletizado: true, urgente: false },
            '061318': { agendado: true, palletizado: true, urgente: false },
            '061324': { agendado: true, palletizado: true, urgente: false },
            '063080': { agendado: true, palletizado: true, urgente: false },
            '063500': { agendado: true, palletizado: true, urgente: false },
            '063705': { agendado: true, palletizado: true, urgente: false },
            '064288': { agendado: true, palletizado: false, urgente: false },
            '066208': { agendado: true, palletizado: false, urgente: false },
            '066590': { agendado: false, palletizado: true, urgente: false },
            '067660': { agendado: true, palletizado: false, urgente: false },
            '067884': { agendado: true, palletizado: true, urgente: false },
            '069281': { agendado: true, palletizado: false, urgente: false },
            '069286': { agendado: true, palletizado: true, urgente: false },
            '069318': { agendado: false, palletizado: true, urgente: false },
            '070968': { agendado: true, palletizado: true, urgente: false },
            '071659': { agendado: true, palletizado: false, urgente: false },
            '072388': { agendado: false, palletizado: true, urgente: false },
            '073847': { agendado: true, palletizado: true, urgente: false },
            '076019': { agendado: true, palletizado: true, urgente: false },
            '076580': { agendado: true, palletizado: true, urgente: false },
            '077475': { agendado: true, palletizado: false, urgente: false },
            '077520': { agendado: true, palletizado: false, urgente: false },
            '078895': { agendado: true, palletizado: false, urgente: false },
            '079838': { agendado: true, palletizado: true, urgente: false },
            '080727': { agendado: true, palletizado: true, urgente: false },
            '081353': { agendado: true, palletizado: true, urgente: false },
            '082255': { agendado: false, palletizado: true, urgente: false },
            '083183': { agendado: true, palletizado: true, urgente: false },
            '083184': { agendado: true, palletizado: false, urgente: false },
            '083634': { agendado: true, palletizado: false, urgente: false },
            '085534': { agendado: true, palletizado: false, urgente: false },
            '086159': { agendado: true, palletizado: true, urgente: false },
            '086350': { agendado: true, palletizado: false, urgente: false },
            '086641': { agendado: true, palletizado: true, urgente: false },
            '089073': { agendado: true, palletizado: false, urgente: false },
            '089151': { agendado: true, palletizado: true, urgente: false },
            '090373': { agendado: false, palletizado: true, urgente: false },
            '091725': { agendado: false, palletizado: true, urgente: false },
            '092017': { agendado: true, palletizado: true, urgente: false },
            '095092': { agendado: true, palletizado: true, urgente: false },
            '095660': { agendado: true, palletizado: false, urgente: false },
            '096758': { agendado: true, palletizado: true, urgente: false },
            '098227': { agendado: true, palletizado: true, urgente: false },
            '099268': { agendado: true, palletizado: false, urgente: false },
            '1': { agendado: false, palletizado: false, urgente: true },
            '100087': { agendado: true, palletizado: true, urgente: false },
            '100522': { agendado: false, palletizado: true, urgente: false },
            '101246': { agendado: false, palletizado: true, urgente: false },
            '101253': { agendado: true, palletizado: true, urgente: false },
            '101346': { agendado: true, palletizado: true, urgente: false },
            '102066': { agendado: false, palletizado: true, urgente: false },
            '103518': { agendado: true, palletizado: false, urgente: false },
            '105394': { agendado: true, palletizado: true, urgente: false },
            '106198': { agendado: true, palletizado: false, urgente: false },
            '108416': { agendado: false, palletizado: true, urgente: false },
            '108765': { agendado: true, palletizado: false, urgente: false },
            '109288': { agendado: true, palletizado: true, urgente: false },
            '109409': { agendado: false, palletizado: true, urgente: false },
            '110023': { agendado: true, palletizado: false, urgente: false },
            '110894': { agendado: false, palletizado: true, urgente: false },
            '111145': { agendado: true, palletizado: true, urgente: false },
            '111154': { agendado: true, palletizado: false, urgente: false },
            '111302': { agendado: true, palletizado: true, urgente: false },
            '112207': { agendado: true, palletizado: false, urgente: false },
            '112670': { agendado: true, palletizado: false, urgente: false },
            '117028': { agendado: true, palletizado: true, urgente: false },
            '117123': { agendado: true, palletizado: true, urgente: false },
            '120423': { agendado: true, palletizado: false, urgente: false },
            '120455': { agendado: false, palletizado: true, urgente: false },
            '120473': { agendado: true, palletizado: false, urgente: false },
            '120533': { agendado: true, palletizado: true, urgente: false },
            '121747': { agendado: true, palletizado: true, urgente: false },
            '122155': { agendado: true, palletizado: false, urgente: false },
            '122785': { agendado: false, palletizado: true, urgente: false },
            '123815': { agendado: true, palletizado: false, urgente: false },
            '124320': { agendado: true, palletizado: true, urgente: false },
            '125228': { agendado: true, palletizado: false, urgente: false },
            '125517': { agendado: false, palletizado: true, urgente: false },
            '126430': { agendado: true, palletizado: false, urgente: false },
            '131476': { agendado: true, palletizado: true, urgente: false },
            '132397': { agendado: true, palletizado: false, urgente: false },
            '133916': { agendado: true, palletizado: false, urgente: false },
            '135395': { agendado: true, palletizado: true, urgente: false },
            '135928': { agendado: true, palletizado: false, urgente: false },
            '136086': { agendado: true, palletizado: false, urgente: false },
            '136260': { agendado: true, palletizado: true, urgente: false },
            '137919': { agendado: true, palletizado: true, urgente: false },
            '138825': { agendado: true, palletizado: true, urgente: false },
            '139013': { agendado: true, palletizado: true, urgente: false },
            '139329': { agendado: true, palletizado: true, urgente: false },
            '139611': { agendado: true, palletizado: true, urgente: false },
            '143102': { agendado: true, palletizado: true, urgente: false },
            '144192': { agendado: true, palletizado: false, urgente: false },
            '144457': { agendado: true, palletizado: true, urgente: false },
            '145014': { agendado: true, palletizado: true, urgente: false },
            '145237': { agendado: true, palletizado: true, urgente: false },
            '145322': { agendado: true, palletizado: false, urgente: false },
            '146644': { agendado: true, palletizado: false, urgente: false },
            '146988': { agendado: true, palletizado: false, urgente: false },
            '148071': { agendado: true, palletizado: false, urgente: false },
            '149598': { agendado: true, palletizado: false, urgente: false },
            '150503': { agendado: true, palletizado: true, urgente: false },
            '151981': { agendado: true, palletizado: false, urgente: false },
            '152601': { agendado: true, palletizado: true, urgente: false },
            '152835': { agendado: true, palletizado: false, urgente: false },
            '152925': { agendado: true, palletizado: true, urgente: false },
            '153289': { agendado: true, palletizado: false, urgente: false },
            '154423': { agendado: true, palletizado: false, urgente: false },
            '154778': { agendado: true, palletizado: true, urgente: false },
            '154808': { agendado: true, palletizado: true, urgente: false },
            '155177': { agendado: true, palletizado: true, urgente: false },
            '155313': { agendado: true, palletizado: false, urgente: false },
            '155368': { agendado: false, palletizado: true, urgente: false },
            '155419': { agendado: true, palletizado: true, urgente: false },
            '155475': { agendado: true, palletizado: false, urgente: false },
            '155823': { agendado: false, palletizado: true, urgente: false },
            '155888': { agendado: true, palletizado: true, urgente: false },
            '156009': { agendado: true, palletizado: true, urgente: false },
            '156585': { agendado: false, palletizado: true, urgente: false },
            '156696': { agendado: true, palletizado: false, urgente: false },
            '157403': { agendado: true, palletizado: true, urgente: false },
            '158235': { agendado: true, palletizado: false, urgente: false },
            '159054': { agendado: true, palletizado: false, urgente: false },
            '159168': { agendado: true, palletizado: false, urgente: false },
            '160382': { agendado: false, palletizado: true, urgente: false },
            '160982': { agendado: true, palletizado: true, urgente: false },
            '161737': { agendado: true, palletizado: true, urgente: false },
            '162499': { agendado: true, palletizado: false, urgente: false },
            '162789': { agendado: true, palletizado: false, urgente: false },
            '163234': { agendado: true, palletizado: false, urgente: false },
            '163382': { agendado: false, palletizado: true, urgente: false },
            '163458': { agendado: true, palletizado: false, urgente: false },
            '164482': { agendado: false, palletizado: true, urgente: false },
            '164721': { agendado: true, palletizado: false, urgente: false },
            '164779': { agendado: true, palletizado: true, urgente: false },
            '164780': { agendado: true, palletizado: true, urgente: false },
            '164924': { agendado: true, palletizado: false, urgente: false },
            '165512': { agendado: true, palletizado: false, urgente: false },
            '166195': { agendado: true, palletizado: true, urgente: false },
            '166337': { agendado: true, palletizado: false, urgente: false },
            '166353': { agendado: true, palletizado: true, urgente: false },
            '166468': { agendado: true, palletizado: false, urgente: false },
            '166469': { agendado: true, palletizado: false, urgente: false },
            '167353': { agendado: false, palletizado: true, urgente: false },
            '167810': { agendado: true, palletizado: false, urgente: false },
            '167819': { agendado: true, palletizado: true, urgente: false },
            '168464': { agendado: true, palletizado: true, urgente: false },
            '169863': { agendado: true, palletizado: true, urgente: false },
            '169971': { agendado: true, palletizado: false, urgente: false },
            '170219': { agendado: true, palletizado: false, urgente: false },
            '170220': { agendado: true, palletizado: false, urgente: false },
            '170516': { agendado: true, palletizado: true, urgente: false },
            '171147': { agendado: true, palletizado: false, urgente: false },
            '171160': { agendado: true, palletizado: false, urgente: false },
            '171191': { agendado: false, palletizado: true, urgente: false },
            '171200': { agendado: true, palletizado: false, urgente: false },
            '171320': { agendado: true, palletizado: true, urgente: false },
            '171529': { agendado: true, palletizado: true, urgente: false },
            '171642': { agendado: true, palletizado: false, urgente: false },
            '171863': { agendado: false, palletizado: true, urgente: false },
            '172270': { agendado: false, palletizado: true, urgente: false },
            '172490': { agendado: true, palletizado: true, urgente: false },
            '172656': { agendado: true, palletizado: false, urgente: false },
            '172859': { agendado: true, palletizado: true, urgente: false },
            '173621': { agendado: false, palletizado: true, urgente: false },
            '173964': { agendado: true, palletizado: false, urgente: false },
            '173977': { agendado: true, palletizado: false, urgente: false },
            '174249': { agendado: true, palletizado: false, urgente: false },
            '174339': { agendado: false, palletizado: false, urgente: true },
            '174593': { agendado: true, palletizado: false, urgente: false },
            '174662': { agendado: true, palletizado: false, urgente: false },
            '174901': { agendado: true, palletizado: true, urgente: false },
            '175108': { agendado: false, palletizado: false, urgente: true },
            '175365': { agendado: true, palletizado: true, urgente: false },
            '175425': { agendado: true, palletizado: false, urgente: false },
            '175762': { agendado: true, palletizado: false, urgente: false },
            '175767': { agendado: true, palletizado: false, urgente: false },
            '175783': { agendado: true, palletizado: false, urgente: false },
            '176166': { agendado: true, palletizado: false, urgente: false },
            '176278': { agendado: true, palletizado: false, urgente: false },
            '176453': { agendado: true, palletizado: false, urgente: false },
            '176747': { agendado: true, palletizado: false, urgente: false },
            '177075': { agendado: false, palletizado: true, urgente: false },
            '177327': { agendado: true, palletizado: false, urgente: false },
            '177488': { agendado: true, palletizado: true, urgente: false },
            '177529': { agendado: true, palletizado: true, urgente: false },
            '177883': { agendado: true, palletizado: false, urgente: false },
            '177951': { agendado: true, palletizado: true, urgente: false },
            '177995': { agendado: true, palletizado: false, urgente: false },
            '178255': { agendado: true, palletizado: false, urgente: false },
            '178377': { agendado: true, palletizado: false, urgente: false },
            '178666': { agendado: true, palletizado: false, urgente: false },
            '179104': { agendado: true, palletizado: false, urgente: false },
            '179302': { agendado: false, palletizado: true, urgente: false },
            '179510': { agendado: true, palletizado: false, urgente: false },
            '179542': { agendado: true, palletizado: false, urgente: false },
            '179690': { agendado: true, palletizado: false, urgente: false },
            '180028': { agendado: true, palletizado: false, urgente: false },
            '180269': { agendado: true, palletizado: false, urgente: false },
            '180342': { agendado: true, palletizado: true, urgente: false },
            '180427': { agendado: true, palletizado: true, urgente: false },
            '180472': { agendado: true, palletizado: false, urgente: false },
            '180494': { agendado: true, palletizado: true, urgente: false },
            '180594': { agendado: true, palletizado: false, urgente: false },
            '180772': { agendado: true, palletizado: true, urgente: false },
            '181012': { agendado: true, palletizado: true, urgente: false },
            '181052': { agendado: true, palletizado: true, urgente: false },
            '181179': { agendado: true, palletizado: true, urgente: false },
            '181199': { agendado: false, palletizado: true, urgente: false },
            '182292': { agendado: false, palletizado: true, urgente: false },
            '182349': { agendado: true, palletizado: true, urgente: false },
            '182571': { agendado: false, palletizado: true, urgente: false },
            '182614': { agendado: false, palletizado: true, urgente: false },
            '182629': { agendado: false, palletizado: true, urgente: false },
            '182696': { agendado: true, palletizado: false, urgente: false },
            '182809': { agendado: true, palletizado: false, urgente: false },
            '182885': { agendado: true, palletizado: true, urgente: false },
            '182901': { agendado: true, palletizado: true, urgente: false },
            '183011': { agendado: true, palletizado: true, urgente: false },
            '183016': { agendado: true, palletizado: false, urgente: false },
            '183046': { agendado: true, palletizado: true, urgente: false },
            '183048': { agendado: true, palletizado: false, urgente: false },
            '183069': { agendado: true, palletizado: true, urgente: false },
            '183070': { agendado: true, palletizado: false, urgente: false },
            '183091': { agendado: true, palletizado: false, urgente: false },
            '183093': { agendado: true, palletizado: true, urgente: false },
            '183256': { agendado: false, palletizado: false, urgente: true },
            '183477': { agendado: true, palletizado: false, urgente: false },
            '183676': { agendado: true, palletizado: true, urgente: false },
            '183787': { agendado: true, palletizado: true, urgente: false },
            '184011': { agendado: true, palletizado: true, urgente: false },
            '184038': { agendado: true, palletizado: true, urgente: false },
            '189677': { agendado: true, palletizado: false, urgente: false },
            '190163': { agendado: true, palletizado: true, urgente: false },
            '190241': { agendado: true, palletizado: true, urgente: false },
            '190687': { agendado: true, palletizado: false, urgente: false },
            '190733': { agendado: true, palletizado: true, urgente: false },
            '191148': { agendado: true, palletizado: false, urgente: false },
            '191149': { agendado: true, palletizado: false, urgente: false },
            '191191': { agendado: true, palletizado: true, urgente: false },
            '191230': { agendado: false, palletizado: true, urgente: false },
            '191271': { agendado: false, palletizado: true, urgente: false },
            '191283': { agendado: true, palletizado: false, urgente: false },
            '191387': { agendado: true, palletizado: false, urgente: false },
            '191506': { agendado: false, palletizado: true, urgente: false },
            '191902': { agendado: true, palletizado: false, urgente: false },
            '191972': { agendado: true, palletizado: true, urgente: false },
            '192138': { agendado: true, palletizado: true, urgente: false },
            '192369': { agendado: true, palletizado: false, urgente: false },
            '192638': { agendado: true, palletizado: false, urgente: false },
            '192713': { agendado: true, palletizado: false, urgente: false },
            '193211': { agendado: true, palletizado: true, urgente: false },
            '193445': { agendado: true, palletizado: false, urgente: false },
            '193509': { agendado: true, palletizado: false, urgente: false },
            '193772': { agendado: false, palletizado: true, urgente: false },
            '194333': { agendado: false, palletizado: true, urgente: false },
            '194432': { agendado: true, palletizado: true, urgente: false },
            '194508': { agendado: true, palletizado: true, urgente: false },
            '194750': { agendado: true, palletizado: false, urgente: false },
            '194751': { agendado: true, palletizado: false, urgente: false },
            '194821': { agendado: true, palletizado: true, urgente: false },
            '194831': { agendado: true, palletizado: true, urgente: false },
            '195287': { agendado: true, palletizado: false, urgente: false },
            '195338': { agendado: true, palletizado: true, urgente: false },
            '195446': { agendado: true, palletizado: false, urgente: false },
            '196083': { agendado: true, palletizado: false, urgente: false },
            '196084': { agendado: true, palletizado: true, urgente: false },
            '196118': { agendado: true, palletizado: false, urgente: false },
            '196405': { agendado: true, palletizado: false, urgente: false },
            '196446': { agendado: true, palletizado: false, urgente: false },
            '196784': { agendado: true, palletizado: false, urgente: false },
            '197168': { agendado: true, palletizado: true, urgente: false },
            '197249': { agendado: true, palletizado: true, urgente: false },
            '197983': { agendado: true, palletizado: true, urgente: false },
            '198187': { agendado: true, palletizado: true, urgente: false },
            '198438': { agendado: true, palletizado: true, urgente: false },
            '198747': { agendado: false, palletizado: true, urgente: false },
            '198774': { agendado: true, palletizado: true, urgente: false },
            '198796': { agendado: true, palletizado: true, urgente: false },
            '198844': { agendado: false, palletizado: true, urgente: false },
            '198895': { agendado: true, palletizado: true, urgente: false },
            '198907': { agendado: true, palletizado: false, urgente: false },
            '198908': { agendado: true, palletizado: false, urgente: false },
            '199172': { agendado: true, palletizado: false, urgente: false },
            '199615': { agendado: true, palletizado: true, urgente: false },
            '199625': { agendado: true, palletizado: false, urgente: false },
            '199650': { agendado: true, palletizado: false, urgente: false },
            '199651': { agendado: true, palletizado: false, urgente: false },
            '199713': { agendado: true, palletizado: false, urgente: false },
            '199733': { agendado: true, palletizado: false, urgente: false },
            '199927': { agendado: true, palletizado: true, urgente: false },
            '199991': { agendado: true, palletizado: false, urgente: false },
            '200091': { agendado: true, palletizado: false, urgente: false },
            '200194': { agendado: true, palletizado: true, urgente: false },
            '200239': { agendado: true, palletizado: true, urgente: false },
            '200253': { agendado: true, palletizado: true, urgente: false },
            '200382': { agendado: true, palletizado: true, urgente: false },
            '200404': { agendado: true, palletizado: false, urgente: false },
            '200597': { agendado: true, palletizado: false, urgente: false },
            '200917': { agendado: true, palletizado: false, urgente: false },
            '201294': { agendado: true, palletizado: false, urgente: false },
            '201455': { agendado: false, palletizado: true, urgente: false },
            '201754': { agendado: true, palletizado: false, urgente: false },
            '201853': { agendado: true, palletizado: true, urgente: false },
            '201936': { agendado: true, palletizado: false, urgente: false },
            '201948': { agendado: true, palletizado: false, urgente: false },
            '201956': { agendado: false, palletizado: true, urgente: false },
            '201958': { agendado: true, palletizado: true, urgente: false },
            '201961': { agendado: true, palletizado: true, urgente: false },
            '201974': { agendado: true, palletizado: true, urgente: false },
            '202022': { agendado: false, palletizado: true, urgente: false },
            '202185': { agendado: false, palletizado: true, urgente: false },
            '202187': { agendado: true, palletizado: true, urgente: false },
            '202199': { agendado: false, palletizado: true, urgente: false },
            '202714': { agendado: true, palletizado: true, urgente: false },
            '202931': { agendado: true, palletizado: false, urgente: false },
            '203072': { agendado: true, palletizado: false, urgente: false },
            '203093': { agendado: true, palletizado: false, urgente: false },
            '203201': { agendado: false, palletizado: true, urgente: false },
            '203435': { agendado: true, palletizado: false, urgente: false },
            '203436': { agendado: true, palletizado: false, urgente: false },
            '203451': { agendado: true, palletizado: false, urgente: false },
            '203512': { agendado: true, palletizado: false, urgente: false },
            '203769': { agendado: false, palletizado: true, urgente: false },
            '204198': { agendado: true, palletizado: true, urgente: false },
            '204659': { agendado: false, palletizado: true, urgente: false },
            '204895': { agendado: true, palletizado: true, urgente: false },
            '204910': { agendado: true, palletizado: true, urgente: false },
            '204911': { agendado: true, palletizado: true, urgente: false },
            '204913': { agendado: true, palletizado: true, urgente: false },
            '204914': { agendado: true, palletizado: true, urgente: false },
            '204915': { agendado: true, palletizado: true, urgente: false },
            '204917': { agendado: true, palletizado: true, urgente: false },
            '204924': { agendado: false, palletizado: true, urgente: false },
            '204971': { agendado: true, palletizado: true, urgente: false },
            '204979': { agendado: true, palletizado: true, urgente: false },
            '205108': { agendado: true, palletizado: true, urgente: false },
            '205121': { agendado: true, palletizado: false, urgente: false },
            '205220': { agendado: false, palletizado: true, urgente: false },
            '205276': { agendado: true, palletizado: false, urgente: false },
            '205744': { agendado: false, palletizado: true, urgente: false },
            '205787': { agendado: true, palletizado: false, urgente: false },
            '205803': { agendado: false, palletizado: true, urgente: false },
            '205868': { agendado: true, palletizado: true, urgente: false },
            '205903': { agendado: true, palletizado: false, urgente: false },
            '206116': { agendado: true, palletizado: false, urgente: false },
            '206163': { agendado: true, palletizado: false, urgente: false },
            '206208': { agendado: true, palletizado: false, urgente: false },
            '206294': { agendado: true, palletizado: true, urgente: false },
            '206380': { agendado: true, palletizado: true, urgente: false },
            '206543': { agendado: true, palletizado: false, urgente: false },
            '206628': { agendado: true, palletizado: false, urgente: false },
            '206730': { agendado: true, palletizado: false, urgente: false },
            '206731': { agendado: true, palletizado: false, urgente: false },
            '206994': { agendado: true, palletizado: true, urgente: false },
            '207024': { agendado: false, palletizado: true, urgente: false },
            '207029': { agendado: true, palletizado: false, urgente: false },
            '207166': { agendado: true, palletizado: false, urgente: false },
            '207403': { agendado: true, palletizado: true, urgente: false },
            '207689': { agendado: true, palletizado: false, urgente: false },
            '207881': { agendado: false, palletizado: true, urgente: false },
            '207902': { agendado: true, palletizado: false, urgente: false },
            '208489': { agendado: true, palletizado: false, urgente: false },
            '208613': { agendado: true, palletizado: false, urgente: false },
            '208622': { agendado: true, palletizado: true, urgente: false },
            '208741': { agendado: true, palletizado: true, urgente: false },
            '208804': { agendado: false, palletizado: true, urgente: false },
            '208822': { agendado: true, palletizado: true, urgente: false },
            '208844': { agendado: true, palletizado: false, urgente: false },
            '208853': { agendado: true, palletizado: true, urgente: false },
            '208922': { agendado: true, palletizado: true, urgente: false },
            '209002': { agendado: true, palletizado: true, urgente: false },
            '209004': { agendado: true, palletizado: true, urgente: false },
            '209248': { agendado: true, palletizado: true, urgente: false },
            '209281': { agendado: true, palletizado: true, urgente: false },
            '209321': { agendado: true, palletizado: true, urgente: false },
            '209322': { agendado: true, palletizado: true, urgente: false },
            '209684': { agendado: true, palletizado: false, urgente: false },
            '209716': { agendado: false, palletizado: true, urgente: false },
            '209729': { agendado: true, palletizado: true, urgente: false },
            '210124': { agendado: false, palletizado: true, urgente: false },
            '210230': { agendado: true, palletizado: false, urgente: false },
            '210490': { agendado: true, palletizado: false, urgente: false },
            '210747': { agendado: true, palletizado: false, urgente: false },
            '210759': { agendado: true, palletizado: false, urgente: false },
            '210819': { agendado: true, palletizado: true, urgente: false },
            '210852': { agendado: true, palletizado: false, urgente: false },
            '211059': { agendado: true, palletizado: false, urgente: false },
            '211110': { agendado: true, palletizado: true, urgente: false },
            '211276': { agendado: true, palletizado: false, urgente: false },
            '211277': { agendado: true, palletizado: false, urgente: false },
            '211279': { agendado: true, palletizado: false, urgente: false },
            '211332': { agendado: true, palletizado: false, urgente: false },
            '211411': { agendado: true, palletizado: true, urgente: false },
            '211936': { agendado: false, palletizado: true, urgente: false },
            '211944': { agendado: false, palletizado: true, urgente: false },
            '211989': { agendado: false, palletizado: true, urgente: false },
            '212078': { agendado: true, palletizado: false, urgente: false },
            '212401': { agendado: true, palletizado: true, urgente: false },
            '212417': { agendado: true, palletizado: false, urgente: false },
            '212573': { agendado: true, palletizado: false, urgente: false },
            '212590': { agendado: true, palletizado: true, urgente: false },
            '212900': { agendado: true, palletizado: false, urgente: false },
            '213188': { agendado: true, palletizado: false, urgente: false },
            '213189': { agendado: true, palletizado: false, urgente: false },
            '213190': { agendado: true, palletizado: false, urgente: false },
            '213202': { agendado: true, palletizado: false, urgente: false },
            '213203': { agendado: true, palletizado: false, urgente: false },
            '213242': { agendado: true, palletizado: false, urgente: false },
            '213442': { agendado: true, palletizado: false, urgente: false },
            '213454': { agendado: true, palletizado: true, urgente: false },
            '213529': { agendado: false, palletizado: true, urgente: false },
            '213552': { agendado: false, palletizado: true, urgente: false },
            '213578': { agendado: false, palletizado: true, urgente: false },
            '213582': { agendado: true, palletizado: true, urgente: false },
            '213855': { agendado: true, palletizado: false, urgente: false },
            '213909': { agendado: true, palletizado: true, urgente: false },
            '213910': { agendado: true, palletizado: true, urgente: false },
            '213967': { agendado: true, palletizado: false, urgente: false },
            '214046': { agendado: true, palletizado: false, urgente: false },
            '214150': { agendado: true, palletizado: false, urgente: false },
            '214387': { agendado: true, palletizado: true, urgente: false },
            '214433': { agendado: true, palletizado: false, urgente: false },
            '214442': { agendado: false, palletizado: true, urgente: false },
            '214490': { agendado: false, palletizado: true, urgente: false },
            '214526': { agendado: false, palletizado: true, urgente: false },
            '214594': { agendado: false, palletizado: true, urgente: false },
            '214746': { agendado: true, palletizado: false, urgente: false },
            '215022': { agendado: true, palletizado: true, urgente: false },
            '215116': { agendado: true, palletizado: true, urgente: false },
            '215160': { agendado: true, palletizado: true, urgente: false },
            '215161': { agendado: true, palletizado: true, urgente: false },
            '215493': { agendado: true, palletizado: false, urgente: false },
            '215494': { agendado: true, palletizado: false, urgente: false },
            '215651': { agendado: true, palletizado: false, urgente: false },
            '215687': { agendado: true, palletizado: false, urgente: false },
            '215733': { agendado: true, palletizado: true, urgente: false },
            '215777': { agendado: true, palletizado: false, urgente: false },
            '215779': { agendado: false, palletizado: true, urgente: false },
            '215942': { agendado: true, palletizado: false, urgente: false },
            '216112': { agendado: true, palletizado: true, urgente: false },
            '216245': { agendado: false, palletizado: true, urgente: false },
            '216393': { agendado: true, palletizado: false, urgente: false },
            '216400': { agendado: true, palletizado: false, urgente: false },
            '216630': { agendado: true, palletizado: true, urgente: false },
            '216684': { agendado: true, palletizado: false, urgente: false },
            '217190': { agendado: true, palletizado: false, urgente: false },
            '217283': { agendado: false, palletizado: true, urgente: false },
            '217310': { agendado: true, palletizado: false, urgente: false },
            '217343': { agendado: true, palletizado: false, urgente: false },
            '217545': { agendado: false, palletizado: true, urgente: false },
            '217605': { agendado: true, palletizado: true, urgente: false },
            '217828': { agendado: true, palletizado: true, urgente: false },
            '217871': { agendado: true, palletizado: true, urgente: false },
            '217872': { agendado: true, palletizado: true, urgente: false },
            '217877': { agendado: true, palletizado: true, urgente: false },
            '217949': { agendado: true, palletizado: false, urgente: false },
            '217965': { agendado: false, palletizado: true, urgente: false },
            '218169': { agendado: true, palletizado: false, urgente: false },
            '218196': { agendado: true, palletizado: false, urgente: false },
            '218383': { agendado: true, palletizado: false, urgente: false },
            '218578': { agendado: true, palletizado: true, urgente: false },
            '218580': { agendado: true, palletizado: true, urgente: false },
            '218628': { agendado: false, palletizado: true, urgente: false },
            '218640': { agendado: true, palletizado: true, urgente: false },
            '218820': { agendado: true, palletizado: true, urgente: false },
            '218845': { agendado: true, palletizado: true, urgente: false },
            '219539': { agendado: true, palletizado: false, urgente: false },
            '219698': { agendado: true, palletizado: true, urgente: false },
            '219715': { agendado: true, palletizado: true, urgente: false },
            '219884': { agendado: true, palletizado: true, urgente: false },
            '220158': { agendado: false, palletizado: true, urgente: false },
            '220183': { agendado: true, palletizado: true, urgente: false },
            '220645': { agendado: true, palletizado: false, urgente: false },
            '220950': { agendado: true, palletizado: true, urgente: false },
            '221023': { agendado: true, palletizado: false, urgente: false },
            '221248': { agendado: false, palletizado: true, urgente: false },
            '221251': { agendado: true, palletizado: true, urgente: false },
            '222164': { agendado: false, palletizado: true, urgente: false },
            '222165': { agendado: false, palletizado: true, urgente: false },
            '223025': { agendado: true, palletizado: false, urgente: false },
            '223379': { agendado: false, palletizado: true, urgente: false },
            '223525': { agendado: true, palletizado: true, urgente: false },
            '223703': { agendado: true, palletizado: false, urgente: false },
            '223727': { agendado: true, palletizado: false, urgente: false },
            '223877': { agendado: true, palletizado: false, urgente: false },
            '223899': { agendado: true, palletizado: false, urgente: false },
            '223900': { agendado: true, palletizado: false, urgente: false },
            '223954': { agendado: true, palletizado: false, urgente: false },
            '223997': { agendado: false, palletizado: true, urgente: false },
            '224956': { agendado: true, palletizado: true, urgente: false },
            '224957': { agendado: true, palletizado: true, urgente: false },
            '224958': { agendado: true, palletizado: true, urgente: false },
            '224959': { agendado: true, palletizado: true, urgente: false },
            '224961': { agendado: true, palletizado: true, urgente: false },
            '224962': { agendado: true, palletizado: true, urgente: false },
            '225112': { agendado: true, palletizado: false, urgente: false },
            '225408': { agendado: true, palletizado: true, urgente: false },
            '225449': { agendado: true, palletizado: false, urgente: false },
            '225904': { agendado: true, palletizado: false, urgente: false },
            '226903': { agendado: true, palletizado: false, urgente: false },
            '226939': { agendado: true, palletizado: false, urgente: false },
            '227190': { agendado: true, palletizado: true, urgente: false },
            '227290': { agendado: false, palletizado: true, urgente: false },
            '227291': { agendado: false, palletizado: true, urgente: false },
            '227292': { agendado: false, palletizado: true, urgente: false },
            '227293': { agendado: false, palletizado: true, urgente: false },
            '227294': { agendado: false, palletizado: true, urgente: false },
            '227300': { agendado: false, palletizado: true, urgente: false },
            '227301': { agendado: false, palletizado: true, urgente: false },
            '227302': { agendado: false, palletizado: true, urgente: false },
            '227303': { agendado: false, palletizado: true, urgente: false },
            '227304': { agendado: false, palletizado: true, urgente: false },
            '227305': { agendado: false, palletizado: true, urgente: false },
            '227306': { agendado: false, palletizado: true, urgente: false },
            '227307': { agendado: false, palletizado: true, urgente: false },
            '227308': { agendado: false, palletizado: true, urgente: false },
            '227309': { agendado: false, palletizado: true, urgente: false },
            '227310': { agendado: false, palletizado: true, urgente: false },
            '227311': { agendado: false, palletizado: true, urgente: false },
            '227312': { agendado: false, palletizado: true, urgente: false },
            '227387': { agendado: true, palletizado: true, urgente: false },
            '227405': { agendado: false, palletizado: true, urgente: false },
            '227406': { agendado: false, palletizado: true, urgente: false },
            '228469': { agendado: false, palletizado: true, urgente: false },
            '228589': { agendado: true, palletizado: false, urgente: false },
            '228693': { agendado: true, palletizado: true, urgente: false },
            '228695': { agendado: true, palletizado: false, urgente: false },
        };
        // <-- FIM DA BASE DE DADOS DE CLIENTES

        let CargasFiorinoFinalizadas = new Map();

        const matrizDeDistancias = {}; // Matriz de distâncias omitida para encurtar, mas está no seu código.

        function calcularDistanciaLocal(loadId) {
            //... função sem alterações
        }
        
        let planilhaData = [];
        let pedidosGeraisAtuais = [];
        let gruposToco = {};
        let pedidosPrioritarios = [];
        let tocoPedidoIds = new Set();

        const defaultConfigs = {
            fiorinoMaxCapacity: 570, fiorinoMinCapacity: 330, fiorinoCubage: 1.6,
            vanMaxCapacity: 1560, vanMinCapacity: 1100, vanCubage: 5.0,
            tresQuartosMaxCapacity: 4100, tresQuartosMinCapacity: 2300, tresQuartosCubage: 15.0,
            tocoMaxCapacity: 8500, tocoMinCapacity: 5000, tocoCubage: 30.0
        };

        // ... resto das funções de configuração (save, load, reset) sem alterações ...
        function saveConfigurations() {
            const configStatus = document.getElementById('configStatus');
            try {
                const configs = {};
                Object.keys(defaultConfigs).forEach(key => { configs[key] = document.getElementById(key).value; });
                localStorage.setItem('vehicleConfigs', JSON.stringify(configs));
                configStatus.innerHTML = '<p class="text-success">Configurações salvas com sucesso!</p>';
                setTimeout(() => { configStatus.innerHTML = ''; }, 3000);
            } catch (error) {
                configStatus.innerHTML = '<p class="text-danger">Erro ao salvar as configurações.</p>';
            }
        }

        function loadConfigurations() {
            const savedConfigs = localStorage.getItem('vehicleConfigs');
            const configs = savedConfigs ? JSON.parse(savedConfigs) : defaultConfigs;
            Object.keys(configs).forEach(key => {
                const element = document.getElementById(key);
                if (element) { element.value = configs[key]; }
            });
        }
        
        function resetFiorino() {
            document.getElementById('fiorinoMaxCapacity').value = defaultConfigs.fiorinoMaxCapacity;
            document.getElementById('fiorinoMinCapacity').value = defaultConfigs.fiorinoMinCapacity;
            document.getElementById('fiorinoCubage').value = defaultConfigs.fiorinoCubage;
            saveConfigurations();
        }
        function resetVan() {
            document.getElementById('vanMaxCapacity').value = defaultConfigs.vanMaxCapacity;
            document.getElementById('vanMinCapacity').value = defaultConfigs.vanMinCapacity;
            document.getElementById('vanCubage').value = defaultConfigs.vanCubage;
            saveConfigurations();
        }
        function resetTresQuartos() {
            document.getElementById('tresQuartosMaxCapacity').value = defaultConfigs.tresQuartosMaxCapacity;
            document.getElementById('tresQuartosMinCapacity').value = defaultConfigs.tresQuartosMinCapacity;
            document.getElementById('tresQuartosCubage').value = defaultConfigs.tresQuartosCubage;
            saveConfigurations();
        }
        function resetToco() {
            document.getElementById('tocoMaxCapacity').value = defaultConfigs.tocoMaxCapacity;
            document.getElementById('tocoMinCapacity').value = defaultConfigs.tocoMinCapacity;
            document.getElementById('tocoCubage').value = defaultConfigs.tocoCubage;
            saveConfigurations();
        }
        function resetAll() {
            Object.keys(defaultConfigs).forEach(key => { document.getElementById(key).value = defaultConfigs[key]; });
            saveConfigurations();
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadConfigurations();
            document.getElementById('saveConfig').addEventListener('click', saveConfigurations);
            document.getElementById('resetFiorino').addEventListener('click', resetFiorino);
            document.getElementById('resetVan').addEventListener('click', resetVan);
            document.getElementById('resetTresQuartos').addEventListener('click', resetTresQuartos);
            document.getElementById('resetToco').addEventListener('click', resetToco);
            document.getElementById('resetAllConfigs').addEventListener('click', resetAll);
        });

        const rotaVeiculoMap = {}; // Omitido para encurtar
        
        // ... Funções handleFile, buscarPedido, priorizarPedido, highlightPedido, processar sem alterações ...
        const fileInput = document.getElementById('fileInput');
        const processarBtn = document.getElementById('processarBtn');
        const statusDiv = document.getElementById('status');
        const dropZone = document.getElementById('drop-zone');
        const dropZoneText = document.getElementById('drop-zone-text');
        const isNumeric = (str) => str && /^\d+$/.test(String(str).trim());

        fileInput.addEventListener('change', (event) => { handleFile(event.target.files[0]); });
        dropZone.addEventListener('dragover', (event) => { event.stopPropagation(); event.preventDefault(); dropZone.classList.add('border-primary'); });
        dropZone.addEventListener('dragleave', (event) => { event.stopPropagation(); event.preventDefault(); dropZone.classList.remove('border-primary'); });
        dropZone.addEventListener('drop', (event) => { event.stopPropagation(); event.preventDefault(); dropZone.classList.remove('border-primary'); handleFile(event.dataTransfer.files[0]); });

        function handleFile(file) {
            if (!file) return;
            statusDiv.innerHTML = '<p class="text-info">Carregando planilha...</p>';
            processarBtn.disabled = true;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    const rawData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    let headerRowIndex = -1, headers = [];
                    for (let i = 0; i < rawData.length; i++) {
                        const row = rawData[i];
                        if (row && row.includes('Cod_Rota')) { headerRowIndex = i; headers = row.map(h => String(h).trim()); break; }
                    }
                    if (headerRowIndex === -1) throw new Error("Não foi possível encontrar a linha de cabeçalho com 'Cod_Rota'.");
                    const dataRows = rawData.slice(headerRowIndex + 1);
                    planilhaData = dataRows.map(row => { const pedido = {}; headers.forEach((header, i) => { if (header) { pedido[header] = row[i] !== undefined ? row[i] : ''; } }); return pedido; });
                    statusDiv.innerHTML = `<p class="text-success">Planilha \"${file.name}\" carregada. ${planilhaData.length} linhas prontas para processar.</p>`;
                    processarBtn.disabled = false;
                    dropZoneText.innerHTML = `<p>Arquivo \"${file.name}\" carregado.</p><button type="button" class="btn btn-secondary" onclick="document.getElementById('fileInput').click()">Selecionar Outro Arquivo</button>`;
                } catch (error) {
                    statusDiv.innerHTML = `<p class="text-danger"><strong>Erro ao ler o arquivo:</strong> ${error.message}</p>`;
                    console.error(error);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function buscarPedido() {
            const searchInput = document.getElementById('pedidoSearchInput').value.trim();
            const searchResultDiv = document.getElementById('search-result');
            searchResultDiv.innerHTML = '';
            if (!searchInput) return;

            if (planilhaData.length === 0) { searchResultDiv.innerHTML = '<p class="text-warning">Por favor, carregue e processe a planilha primeiro.</p>'; return; }

            let pedidoEncontrado = null; let local = 'Não encontrado'; let accordionId = '';

            pedidoEncontrado = pedidosGeraisAtuais.find(p => String(p.Num_Pedido) === searchInput);
            if (pedidoEncontrado) { local = 'Resultados Gerais'; accordionId = 'accordionGeral'; }

            if (!pedidoEncontrado) {
                for (const cf in gruposToco) {
                    pedidoEncontrado = gruposToco[cf].pedidos.find(p => String(p.Num_Pedido) === searchInput);
                    if (pedidoEncontrado) { local = `Cargas "Toco" (CF: ${cf})`; accordionId = 'accordionToco'; break; }
                }
            }
            
            if (!pedidoEncontrado) {
                const originalPedido = planilhaData.find(p => String(p.Num_Pedido) === searchInput);
                if (originalPedido) {
                    pedidoEncontrado = originalPedido;
                    if (tocoPedidoIds.has(String(originalPedido.Num_Pedido))) { local = 'Filtrado (pertence a um grupo Toco)'; }
                    else if (isNumeric(originalPedido.CF)) { local = 'Filtrado (possui CF numérico)'; }
                    else if (['21', '23', '17'].includes(String(originalPedido.Coluna4))) { local = 'Filtrado (Coluna4 é 21, 23, ou 17)'; } 
                    else if (String(originalPedido['BLOQ.']) === 'C' || String(originalPedido['BLOQ.']) === 'V') { local = 'Filtrado (Bloqueio C ou V)'; } 
                    else { local = 'Filtrado (outro motivo, verifique filtros)'; }
                }
            }

            if (pedidoEncontrado) {
                let buttons = '';
                if (local === 'Resultados Gerais') {
                    const isPrioritized = pedidosPrioritarios.includes(String(pedidoEncontrado.Num_Pedido));
                    buttons = `<button class="btn btn-primary btn-sm" onclick="priorizarPedido('${pedidoEncontrado.Num_Pedido}')" ${isPrioritized ? 'disabled' : ''}>${isPrioritized ? 'Prioridade Marcada' : 'Marcar como Prioridade'}</button>
                                   <button class="btn btn-secondary btn-sm ms-2" onclick="highlightPedido('${pedidoEncontrado.Num_Pedido}')">Destacar na Lista</button>`;
                } else if (accordionId) {
                         buttons = `<button class="btn btn-secondary btn-sm" onclick="highlightPedido('${pedidoEncontrado.Num_Pedido}')">Destacar na Lista</button>`;
                }
                searchResultDiv.innerHTML = `<div class="alert alert-info"><h5>Pedido ${searchInput} encontrado!</h5><p class="mb-1"><strong>Local:</strong> ${local}</p><p class="mb-1"><strong>Cliente:</strong> ${pedidoEncontrado.Nome_Cliente}<br><strong>Peso:</strong> ${pedidoEncontrado.Quilos_Saldo} kg</p>${buttons ? `<div class="mt-2">${buttons}</div>` : ''}</div>`;
            } else { searchResultDiv.innerHTML = '<p class="text-danger">Pedido não encontrado em nenhuma das listas.</p>'; }
        }

        function priorizarPedido(numPedido) { if (!pedidosPrioritarios.includes(numPedido)) { pedidosPrioritarios.push(numPedido); buscarPedido(); } }

        function highlightPedido(numPedido) {
            const row = document.getElementById(`pedido-${numPedido}`);
            if (row) {
                row.classList.toggle('table-info');
                if (row.classList.contains('table-info')) {
                    const collapseEl = row.closest('.accordion-collapse');
                    if (collapseEl && !collapseEl.classList.contains('show')) { bootstrap.Collapse.getOrCreateInstance(collapseEl).show(); }
                    setTimeout(() => { row.scrollIntoView({ behavior: 'smooth', block: 'center' }); }, 350);
                }
            }
        }

        function processar() {
            const resultadoGeralDiv = document.getElementById('resultado-geral');
            const resultadoTocoDiv = document.getElementById('resultado-toco');
            const resultadoTresQuartosDiv = document.getElementById('resultado-tres-quartos');
            try {
                if (planilhaData.length === 0) { statusDiv.innerHTML = '<p class="text-danger">Nenhum dado de planilha carregado.</p>'; return; }
                const rotaInicialInput = document.getElementById('rotaInicialInput').value; const rotaFinalInput = document.getElementById('rotaFinalInput').value;
                resultadoGeralDiv.innerHTML = ''; resultadoTocoDiv.innerHTML = ''; resultadoTresQuartosDiv.innerHTML = '';

                const pedidos = planilhaData.filter(p => String(p.Coluna4) != '500');

                const pedidosTocoBase = pedidos.filter(p => (p.Coluna4 && String(p.Coluna4).toUpperCase().includes('TOCO')) || (p.Coluna5 && String(p.Coluna5).toUpperCase().includes('TOCO')));
                const cfCounts = {};
                pedidosTocoBase.forEach(p => { if (p.CF && isNumeric(p.CF)) { cfCounts[p.CF] = (cfCounts[p.CF] || 0) + 1; } });
                const cfsRepetidos = Object.keys(cfCounts).filter(cf => cfCounts[cf] > 1);
                const pedidosTocoFiltrados = pedidosTocoBase.filter(p => cfsRepetidos.includes(String(p.CF)));
                gruposToco = pedidosTocoFiltrados.reduce((acc, p) => {
                    const cf = p.CF;
                    if (!acc[cf]) { acc[cf] = { pedidos: [], totalKg: 0 }; } acc[cf].pedidos.push(p); acc[cf].totalKg += parseFloat(String(p.Quilos_Saldo).replace(',', '.')) || 0; return acc;
                }, {});
                displayToco(resultadoTocoDiv, gruposToco);

                tocoPedidoIds = new Set(pedidosTocoFiltrados.map(p => String(p.Num_Pedido)));
                const clientesComBloqueio = new Set(); const clientesSemBloqueio = new Set();
                pedidos.forEach(p => { if (String(p['BLOQ.']) === 'C' || String(p['BLOQ.']) === 'V') { clientesComBloqueio.add(String(p.Cliente)); } else { clientesSemBloqueio.add(String(p.Cliente)); } });
                const clientesParaRemover = new Set([...clientesComBloqueio].filter(c => clientesSemBloqueio.has(c)));
                const rotaMin = rotaInicialInput ? parseInt(rotaInicialInput, 10) : 0; const rotaMax = rotaFinalInput ? parseInt(rotaFinalInput, 10) : 99999;
                
                const pedidosGeraisFiltrados = pedidos.filter(p => {
                    if (tocoPedidoIds.has(String(p.Num_Pedido))) return false;
                    if (['21', '23', '17'].includes(String(p.Coluna4))) return false;
                    if (isNumeric(p.CF)) { return false; }
                    const rotaAtualNum = parseInt(String(p.Cod_Rota), 10);
                    if (rotaMin > 0 && rotaMax > 0 && !(rotaAtualNum >= rotaMin && rotaAtualNum <= rotaMax)) return false;
                    if (String(p['BLOQ.']) === 'C' || String(p['BLOQ.']) === 'V') return false;
                    if (clientesParaRemover.has(String(p.Cliente))) return false;
                    return true;
                });

                let tresQuartosLoads = [];
                const MIN_KG_3_4 = parseFloat(document.getElementById('tresQuartosMinCapacity').value) || defaultConfigs.tresQuartosMinCapacity;
                const MAX_KG_3_4 = parseFloat(document.getElementById('tresQuartosMaxCapacity').value) || defaultConfigs.tresQuartosMaxCapacity;
                const LARGE_ORDER_KG = 1700;

                const largeOrdersByRoute = pedidosGeraisFiltrados.reduce((acc, p) => {
                    const peso = parseFloat(String(p.Quilos_Saldo).replace(',', '.')) || 0;
                    if (peso >= LARGE_ORDER_KG) { const rota = p.Cod_Rota; if (!acc[rota]) acc[rota] = []; acc[rota].push(p); } return acc;
                }, {});
                const pedidosEmCargas3_4 = new Set();
                Object.keys(largeOrdersByRoute).forEach(rota => {
                    const largeOrders = largeOrdersByRoute[rota];
                    if (largeOrders.length === 1) {
                        const largeOrder = largeOrders[0]; if (pedidosEmCargas3_4.has(largeOrder.Num_Pedido)) return;
                        let newLoad = { pedidos: [largeOrder], totalKg: parseFloat(String(largeOrder.Quilos_Saldo).replace(',', '.')) || 0, rota: rota };
                        const otherOrdersInRoute = pedidosGeraisFiltrados.filter(p => p.Cod_Rota === rota && p.Num_Pedido !== largeOrder.Num_Pedido).sort((a, b) => (parseFloat(String(b.Quilos_Saldo).replace(',', '.')) || 0) - (parseFloat(String(a.Quilos_Saldo).replace(',', '.')) || 0));
                        for (const order of otherOrdersInRoute) {
                            if (pedidosEmCargas3_4.has(order.Num_Pedido)) continue;
                            const orderKg = parseFloat(String(order.Quilos_Saldo).replace(',', '.')) || 0;
                            if (newLoad.totalKg + orderKg <= MAX_KG_3_4) { newLoad.pedidos.push(order); newLoad.totalKg += orderKg; }
                        }
                        if (newLoad.totalKg >= MIN_KG_3_4) { tresQuartosLoads.push(newLoad); newLoad.pedidos.forEach(p => pedidosEmCargas3_4.add(p.Num_Pedido)); }
                    }
                });
                tresQuartosLoads.forEach((load, index) => { load.numero = index + 1; });
                displayTresQuartos(resultadoTresQuartosDiv, tresQuartosLoads);

                pedidosGeraisAtuais = pedidosGeraisFiltrados.filter(p => !pedidosEmCargas3_4.has(p.Num_Pedido));
                
                const gruposGerais = pedidosGeraisAtuais.reduce((acc, p) => {
                    const rota = p.Cod_Rota; if (!acc[rota]) { acc[rota] = { pedidos: [], totalKg: 0 }; } acc[rota].pedidos.push(p); acc[rota].totalKg += parseFloat(String(p.Quilos_Saldo).replace(',', '.')) || 0; return acc;
                }, {});
                displayGerais(resultadoGeralDiv, gruposGerais);

            } catch (error) { statusDiv.innerHTML = `<p class="text-danger"><strong>Ocorreu um erro:</strong></p><pre>${error.stack}</pre>`; console.error(error); }
        }

        // <-- MUDANÇA PRINCIPAL AQUI: A função createTable foi modificada
        function createTable(pedidos, columnsToDisplay) {
            if (!pedidos || pedidos.length === 0) return '';
            
            // Adicionando a coluna 'Status' como padrão
            const colunasExibir = columnsToDisplay || ['Cod_Rota', 'Cliente', 'Nome_Cliente', 'Status', 'Num_Pedido', 'Quilos_Saldo', 'Cubagem', 'Cidade'];
            
            let table = '<div class="table-responsive"><table class="table table-sm table-bordered table-striped"><thead><tr>';
            colunasExibir.forEach(c => table += `<th>${c}</th>`);
            table += '</tr></thead><tbody>';
            
            pedidos.forEach(p => {
                table += `<tr id="pedido-${p.Num_Pedido}">`;
                colunasExibir.forEach(c => {
                    if (c === 'Status') {
                        // Lógica especial para a coluna Status
                        let statusHtml = '';
                        // Usamos trim() para remover espaços em branco que podem vir da planilha
                        const statusInfo = clientStatusMap[String(p.Cliente).trim()];
                        if (statusInfo) {
                            if (statusInfo.agendado) statusHtml += '<span class="badge bg-primary me-1">Agendado</span>';
                            if (statusInfo.palletizado) statusHtml += '<span class="badge bg-secondary me-1">Palletizado</span>';
                            if (statusInfo.urgente) statusHtml += '<span class="badge bg-danger me-1">Urgente</span>';
                        }
                        table += `<td>${statusHtml || '-'}</td>`;
                    } else {
                        // Lógica original para as outras colunas
                        table += `<td>${p[c] === undefined || p[c] === null ? '' : p[c]}</td>`;
                    }
                });
                table += '</tr>';
            });
            
            table += '</tbody></table></div>';
            return table;
        }

        function displayGerais(div, grupos) {
            if (Object.keys(grupos).length === 0) { div.innerHTML = '<div class="text-center p-3">Nenhum pedido geral encontrado.</div>'; return; }
            let accordionHtml = '<div class="accordion accordion-flush" id="accordionGeral">';
            Object.keys(grupos).sort().forEach((rota, index) => {
                const grupo = grupos[rota];
                const totalKgFormatado = grupo.totalKg.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                const veiculo = rotaVeiculoMap[rota] || 'Toco';
                accordionHtml += `<div class="accordion-item"><h2 class="accordion-header" id="headingGeral${index}"><button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseGeral${index}"><strong>Rota: ${rota} (${veiculo})</strong> &nbsp; <span class="badge bg-secondary ms-2"><i class="bi bi-box me-1"></i>${grupo.pedidos.length} pedidos</span> <span class="badge bg-info ms-2"><i class="bi bi-database me-1"></i>${totalKgFormatado} kg</span></button></h2><div id="collapseGeral${index}" class="accordion-collapse collapse" data-bs-parent="#accordionGeral"><div class="accordion-body">${createTable(grupo.pedidos)}</div></div></div>`;
            });
            accordionHtml += '</div>'; div.innerHTML = accordionHtml;
        }

        function displayTresQuartos(div, loads) {
            // ... função sem alterações ...
        }
        
        // ... Funções packLoads, separarCargasGeneric, renderLoadCard, etc., sem alterações ...
        function packLoads(pedidos, vehicleType) {
            const MIN_KG = parseFloat(document.getElementById(`${vehicleType}MinCapacity`).value);
            const MAX_KG = parseFloat(document.getElementById(`${vehicleType}MaxCapacity`).value);
            const MAX_CUBAGEM = parseFloat(document.getElementById(`${vehicleType}Cubage`).value);
            
            const specialClientNames = ['IRMAOS MUFFATO S.A', 'FINCO & FINCO'];
            const isSpecialClient = (p) => p.Nome_Cliente && specialClientNames.includes(p.Nome_Cliente.toUpperCase().trim());

            let packableItems = [];
            const otherPedidos = pedidos.filter(p => !isSpecialClient(p));
            const specialPedidos = pedidos.filter(p => isSpecialClient(p));

            specialPedidos.forEach(pedido => {
                packableItems.push({
                    isSpecial: true,
                    pedidos: [pedido],
                    totalKg: parseFloat(String(pedido.Quilos_Saldo).replace(',', '.')) || 0,
                    totalCubagem: parseFloat(String(pedido.Cubagem).replace(',', '.')) || 0,
                });
            });

            const otherClientGroupsMap = otherPedidos.reduce((acc, pedido) => {
                const clienteId = pedido.Cliente;
                if (!acc[clienteId]) {
                    acc[clienteId] = { isSpecial: false, pedidos: [], totalKg: 0, totalCubagem: 0 };
                }
                acc[clienteId].pedidos.push(pedido);
                return acc;
            }, {});
            
            Object.values(otherClientGroupsMap).forEach(group => {
                group.totalKg = group.pedidos.reduce((sum, p) => sum + (parseFloat(String(p.Quilos_Saldo).replace(',', '.')) || 0), 0);
                group.totalCubagem = group.pedidos.reduce((sum, p) => sum + (parseFloat(String(p.Cubagem).replace(',', '.')) || 0), 0);
                packableItems.push(group);
            });

            const priorityItems = packableItems.filter(item => item.pedidos.some(p => pedidosPrioritarios.includes(String(p.Num_Pedido))));
            const regularItems = packableItems.filter(item => !item.pedidos.some(p => pedidosPrioritarios.includes(String(p.Num_Pedido))));
            priorityItems.sort((a, b) => b.totalKg - a.totalKg);
            regularItems.sort((a, b) => b.totalKg - a.totalKg);
            packableItems = [...priorityItems, ...regularItems];

            let loads = [];
            let leftoverItems = [];
            packableItems.forEach(item => {
                if (item.totalKg > MAX_KG || item.totalCubagem > MAX_CUBAGEM) {
                    leftoverItems.push(item);
                    return;
                }
                let placed = false;
                for (const load of loads) {
                    const specialCountInLoad = load.pedidos.filter(p => isSpecialClient(p)).length;
                    const specialOrdersInItem = item.isSpecial ? item.pedidos.length : 0;
                    if ((load.totalKg + item.totalKg <= MAX_KG) && (load.totalCubagem + item.totalCubagem <= MAX_CUBAGEM) && (specialCountInLoad + specialOrdersInItem <= 2)) {
                        load.pedidos.push(...item.pedidos);
                        load.totalKg += item.totalKg;
                        load.totalCubagem += item.totalCubagem;
                        placed = true;
                        break;
                    }
                }
                if (!placed) {
                    loads.push({
                        pedidos: [...item.pedidos],
                        totalKg: item.totalKg,
                        totalCubagem: item.totalCubagem,
                    });
                }
            });

            let finalLoads = [];
            let unplacedFromMinRule = [];
            loads.forEach(load => {
                const hasPriority = load.pedidos.some(p => pedidosPrioritarios.includes(String(p.Num_Pedido)));
                if (hasPriority || load.totalKg >= MIN_KG) {
                    finalLoads.push(load);
                } else {
                    unplacedFromMinRule.push(...load.pedidos);
                }
            });
            
            const leftovers = leftoverItems.flatMap(item => item.pedidos).concat(unplacedFromMinRule);
            return { loads: finalLoads, leftovers };
        }


        function separarCargasGeneric(routeOrRoutes, divId, title, vehicleType) {
            const resultadoDiv = document.getElementById(divId);
            resultadoDiv.innerHTML = '';
            if (planilhaData.length === 0) {
                resultadoDiv.innerHTML = '<p class="text-danger">Nenhum dado de planilha carregado.</p>';
                return;
            }

            const routes = Array.isArray(routeOrRoutes) ? routeOrRoutes : [routeOrRoutes];
            const pedidosRota = pedidosGeraisAtuais.filter(p => routes.includes(String(p.Cod_Rota)));

            const primaryResult = packLoads(pedidosRota, vehicleType);
            let primaryLoads = primaryResult.loads;
            let currentLeftovers = primaryResult.leftovers;
            let promotedLoads = [];

            if (vehicleType === 'fiorino' && currentLeftovers.some(p => (parseFloat(String(p.Quilos_Saldo).replace(',', '.')) || 0) >= 600)) {
                const promotedResult = packLoads(currentLeftovers, 'van');
                promotedLoads = promotedResult.loads;
                currentLeftovers = promotedResult.leftovers;
            }
            else if (vehicleType === 'van' && currentLeftovers.some(p => (parseFloat(String(p.Quilos_Saldo).replace(',', '.')) || 0) >= 1650)) {
                const promotedResult = packLoads(currentLeftovers, 'tresQuartos');
                promotedLoads = promotedResult.loads;
                currentLeftovers = promotedResult.leftovers;
            }
            
            primaryLoads.forEach((load, index) => { load.numero = index + 1; });
            promotedLoads.forEach((load, index) => { load.numero = index + 1; });
            
            if (vehicleType === 'fiorino') {
                CargasFiorinoFinalizadas.clear();
                primaryLoads.forEach(load => {
                    const loadId = `fiorino-${title.replace(/\s+/g, '-')}-${load.numero}`;
                    load.id = loadId;
                    CargasFiorinoFinalizadas.set(loadId, load);
                });
            }

            const vehicleInfo = {
                fiorino: { name: 'Fiorino', colorClass: 'bg-success', textColor: 'text-white' },
                van: { name: 'Van', colorClass: 'bg-primary', textColor: 'text-white' },
                tresQuartos: { name: '3/4', colorClass: 'bg-warning', textColor: 'text-dark' }
            };

            let html = '';
            
            const vInfo = vehicleInfo[vehicleType];
            html += `<div class="d-flex justify-content-between align-items-center mb-2"><h4 class="mb-0">${primaryLoads.length} Carga(s) de ${vInfo.name} para ${title}:</h4>${(primaryLoads.length > 0 || promotedLoads.length > 0) ? `<button class="btn btn-sm btn-outline-light no-print" onclick="imprimirCargasGeneric('${divId}', 'Cargas de ${vInfo.name} - ${title}')"><i class="bi bi-printer-fill me-1"></i>Imprimir Cargas</button>` : ''}</div>`;
            if (primaryLoads.length === 0) { html += `<p>Nenhuma carga de ${vInfo.name} foi formada.</p>`; }

            primaryLoads.forEach(load => {
                html += renderLoadCard(load, vehicleType, vInfo);
            });

            if (promotedLoads.length > 0) {
                const promotedVehicleType = (vehicleType === 'fiorino') ? 'van' : 'tresQuartos';
                const pVInfo = vehicleInfo[promotedVehicleType];
                html += `<hr class="my-4"><div class="d-flex justify-content-between align-items-center mb-2"><h4 class="mb-0 text-info"><i class="bi bi-star-fill me-2"></i>${promotedLoads.length} Carga(s) Promovida(s) para ${pVInfo.name}:</h4></div>`;
                
                promotedLoads.forEach(load => {
                    html += renderLoadCard(load, promotedVehicleType, pVInfo, true);
                });
            }

            if (currentLeftovers.length > 0) {
                const totalKgUnassigned = currentLeftovers.reduce((sum, p) => sum + (parseFloat(String(p.Quilos_Saldo).replace(',', '.')) || 0), 0);
                html += `<h5 class="mt-4">Pedidos restantes: ${totalKgUnassigned.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} kg</h5><div class="card mb-3"><div class="card-header bg-danger text-white">Detalhes dos Pedidos Restantes</div><div class="card-body">${createTable(currentLeftovers, ['Num_Pedido', 'Quilos_Saldo', 'Cubagem', 'Cliente', 'Nome_Cliente', 'Cidade'])}</div></div>`;
            }

            resultadoDiv.innerHTML = html;
        }

        function renderLoadCard(load, vehicleType, vInfo, isPromoted = false) {
            load.pedidos.sort((a, b) => {
                const clienteA = String(a.Cliente);
                const clienteB = String(b.Cliente);
                const pedidoA = String(a.Num_Pedido);
                const pedidoB = String(b.Num_Pedido);

                if (clienteA < clienteB) return -1;
                if (clienteA > clienteB) return 1;
                
                return pedidoA.localeCompare(pedidoB);
            });

            const totalKgFormatado = load.totalKg.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            const totalCubagemFormatado = load.totalCubagem.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            const isPriorityLoad = load.pedidos.some(p => pedidosPrioritarios.includes(String(p.Num_Pedido)));
            const priorityBadge = isPriorityLoad ? '<span class="badge bg-light text-dark ms-3">PRIORIDADE</span>' : '';
            const promotedBadge = isPromoted ? '<span class="badge bg-info-subtle text-info-emphasis ms-3">PROMOVIDA</span>' : '';

            let fiorinoDistanceHtml = '';
            if (vehicleType === 'fiorino') {
                fiorinoDistanceHtml = `
                    <div class="d-flex justify-content-between align-items-center mt-2 pt-2 border-top border-secondary">
                       <span id="dist-${load.id}"></span>
                       <button class="btn btn-outline-info btn-sm no-print" onclick="calcularDistanciaLocal('${load.id}')"><i class="bi bi-geo-alt-fill me-2"></i>Calcular KM Estimado</button>
                    </div>`;
            }

            return `
                <div class="card mb-3 ${isPriorityLoad ? 'border-primary' : ''}">
                    <div class="card-header ${vInfo.colorClass} ${vInfo.textColor}">
                        <i class="bi bi-box-seam-fill me-2"></i>${vInfo.name} #${load.numero} - <i class="bi bi-database me-1"></i>Total: ${totalKgFormatado} kg / <i class="bi bi-rulers me-1"></i>${totalCubagemFormatado} m³ ${priorityBadge} ${promotedBadge}
                    </div>
                    <div class="card-body">
                        ${createTable(load.pedidos)}
                        ${fiorinoDistanceHtml}
                    </div>
                </div>`;
        }
        
        function separarCargasFiorino(routes, divId, title) { separarCargasGeneric(routes, divId, title, 'fiorino'); }
        function separarCargasVan(routes, divId, title) { separarCargasGeneric(routes, divId, title, 'van'); }
        function separarCargas34(routes, divId, title) { separarCargasGeneric(routes, divId, title, 'tresQuartos'); }

        function displayToco(div, grupos) {
             // ... função sem alterações ...
        }

        function imprimirCargasGeneric(divId, title) {
            const divToPrint = document.getElementById(divId);
            if (!divToPrint) return;

            const completedLoadsCards = divToPrint.querySelectorAll('.card .card-header:not(.bg-danger)');
            
            if (completedLoadsCards.length === 0) {
                alert("Nenhuma carga concluída para imprimir.");
                return;
            }

            const printWindow = window.open('', '', 'height=800,width=1200');
            printWindow.document.write('<html><head><title>Imprimir: ' + title + '</title>');
            printWindow.document.write('<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">');
            printWindow.document.write(`<style>
                body { margin: 20px; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
                .card { break-inside: avoid; margin-bottom: 1rem; page-break-inside: avoid; }
                .no-print { display: none !important; }
                .bg-success { background-color: #198754 !important; color: white !important; }
                .bg-primary { background-color: #0d6efd !important; color: white !important; }
                .bg-warning { background-color: #ffc107 !important; color: black !important; }
                .table-responsive { overflow: visible !important; }
                table, th, td { border: 1px solid #dee2e6 !important; }
                h1, h2, h3, h4, h5 { margin-top: 1rem; margin-bottom: 0.5rem; }
            </style></head><body>`);
            
            let contentToPrint = `<h3>${title}</h3>`;
            completedLoadsCards.forEach(header => { 
                contentToPrint += header.closest('.card.mb-3').outerHTML; 
            });

            printWindow.document.body.innerHTML = contentToPrint;
            printWindow.document.close();
            printWindow.focus(); 
            setTimeout(() => { printWindow.print(); printWindow.close(); }, 500);
        }

        function imprimirTocoIndividual(cf) {
            // ... função sem alterações ...
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
